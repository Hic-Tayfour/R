---
title: |
  <div style="text-align: center; margin-top: 30px;">
    <h1 style="font-size: 24px;"><strong>INSPER ‚Äì INSTITUTO DE ENSINO E PESQUISA</strong></h1>
    <h2 style="font-style: italic; font-size: 20px;">Curso de Economia</h2>
    <div style="margin-top: 30px;"></div>
    <h3 style="font-size: 20px;">Problemas em Economia</h3>
    <p style="font-size: 18px;"><strong>Tema:</strong> A Rela√ß√£o entre a Independ√™ncia do Banco Central e a Pot√™ncia da Pol√≠tica Monet√°ria</p>
  </div>

subtitle: |
  <div style="text-align: center; margin-top: 30px;">
    <p style="font-size: 16px;"><strong>Professores:</strong></p>
    <p style="font-size: 15px;">Juliana Inhasz<br>
    S√©rgio Ricardo Martins<br>
    Paulo Jose Mencacci Costa (Prof. Auxiliar)</p>
  </div>

author: |
  <div style="text-align: center; margin-top: 30px;">
    <p style="font-size: 16px;"><strong>Integrantes:</strong></p>
    <p style="font-size: 14px;">
      Caio Santa Rosa Christovam ‚Äì <a href="mailto:caiosrc@al.insper.edu.br">caiosrc@al.insper.edu.br</a><br>
      √ârika Kaori Fuzisaka ‚Äì <a href="mailto:erikakf1@al.insper.edu.br">erikakf1@al.insper.edu.br</a><br>
      Hicham Munir Tayfour ‚Äì <a href="mailto:hichamt@al.insper.edu.br">hichamt@al.insper.edu.br</a><br>
      Lucas Batista Ferreira ‚Äì <a href="mailto:lucasbf1@al.insper.edu.br">lucasbf1@al.insper.edu.br</a><br>
      Maria Antonia Pereira Guimar√£es ‚Äì <a href="mailto:mariaapg1@al.insper.edu.br">mariaapg1@al.insper.edu.br</a><br>
      Maria Eduarda Marques Pereira ‚Äì <a href="mailto:mariaemp@al.insper.edu.br">mariaemp@al.insper.edu.br</a><br>
      Maria Morais Garcia Leal ‚Äì <a href="mailto:mariamgl@al.insper.edu.br">mariamgl@al.insper.edu.br</a>
    </p>
  </div>

date: |
  <div style="text-align: center; margin-top: 20px;">
    <p><strong>S√£o Paulo ‚Äì Fevereiro de 2025</strong></p>
  </div>

output:
  html_document:
    toc: true
    toc_float: true
    number_sections: true
    theme: flatly
    highlight: tango
    df_print: paged

fontsize: 12pt
encoding: UTF-8
lang: pt-BR
---

------------------------------------------------------------------------

# Hip√≥tese de Pesquisa

Este estudo busca avaliar empiricamente a seguinte hip√≥tese:

> **Hip√≥tese**: Quanto maior o grau de independ√™ncia do Banco Central, maior ser√° a pot√™ncia da pol√≠tica monet√°ria no controle inflacion√°rio.

Mais especificamente, assume-se que bancos centrais com maior autonomia institucional possuem maior credibilidade e capacidade de ancorar expectativas, o que se reflete em uma resposta mais efetiva da infla√ß√£o √† pol√≠tica monet√°ria.

Para testar essa hip√≥tese, ser√° conduzida uma an√°lise emp√≠rica baseada em dados internacionais, com foco na rela√ß√£o entre:

-   O **grau de independ√™ncia do Banco Central** (medido por um √≠ndice padronizado ou por classifica√ß√£o categ√≥rica), e

-   A **pot√™ncia da pol√≠tica monet√°ria**, avaliada por meio da resposta da infla√ß√£o a varia√ß√µes na taxa de juros real.

Modelos econom√©tricos e an√°lises descritivas complementares ser√£o utilizados para investigar essa rela√ß√£o ao longo do tempo e entre diferentes grupos de pa√≠ses (por regime monet√°rio e institui√ß√µes).

# ‚öôÔ∏è Configura√ß√£o do Ambiente

```{r config}
knitr::opts_chunk$set(fig.width=15, fig.height=10)

```

# üì¶ Carregando Pacotes

```{r setup, message=FALSE, warning=FALSE}

# Manipula√ß√£o e Visualiza√ß√£o de Dados
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggthemes)
library(ggtext)
library(patchwork)
library(gridExtra)
library(CGPfunctions)
library(scales)
library(viridis)
library(ggstream)
library(gganimate)
library(plotly)

# An√°lise de S√©ries Temporais e Dados Econ√¥micos
library(tidyquant)
library(WDI)
library(imf.data)
library(seasonal)
library(mFilter)
library(zoo)
library(sidrar)

# Modelagem e Econometria
library(plm)
library(broom)

# Geodados e Mapas
library(rnaturalearth)
library(sf)
library(countrycode)

# Leitura e Organiza√ß√£o de Dados
library(readxl)
library(labelled)

# Tabelas Profissionais
library(gt)
library(gtExtras)
library(stargazer)

```

# üìÉ Importando e Ajustando as Bases de Dados

Nesta se√ß√£o, realizamos a importa√ß√£o e integra√ß√£o das principais bases de dados macroecon√¥micos utilizadas no estudo. As informa√ß√µes s√£o obtidas a partir de fontes confi√°veis, como o Banco Mundial (WDI), o FMI (IFS), e arquivos auxiliares em Excel contendo o √≠ndice de independ√™ncia dos Bancos Centrais e expectativas de infla√ß√£o. O objetivo √© construir uma base padronizada, consistente e apropriada para a an√°lise emp√≠rica.

## üì• Download de Indicadores do Banco Mundial

```{r importacao-indicadores, message=FALSE, warning=FALSE}
# Consulta aos indicadores dispon√≠veis no WDI
indicadores <- WDIsearch()

# Lista de agrupamentos macroecon√¥micos para exclus√£o
agrupamentos <- c(
  "Africa Eastern and Southern", "Africa Western and Central", "Arab World",
  "Early-demographic dividend", "East Asia & Pacific", 
  "East Asia & Pacific (excluding high income)",
  "East Asia & Pacific (IDA & IBRD countries)", "Euro area",
  "Europe & Central Asia", "Europe & Central Asia (excluding high income)",
  "Europe & Central Asia (IDA & IBRD countries)", "European Union",
  "Fragile and conflict affected situations", "Heavily indebted poor countries (HIPC)",
  "High income", "IBRD only", "IDA & IBRD total", "IDA blend", "IDA only",
  "IDA total", "Late-demographic dividend", "Latin America & Caribbean",
  "Latin America & Caribbean (excluding high income)",
  "Latin America & the Caribbean (IDA & IBRD countries)",
  "Least developed countries: UN classification", "Low & middle income",
  "Low income", "Lower middle income", "Middle East & North Africa",
  "Middle East & North Africa (excluding high income)",
  "Middle East & North Africa (IDA & IBRD countries)", "Middle income",
  "Not classified", "OECD members", "Other small states", 
  "Pacific island small states", "Post-demographic dividend", 
  "Pre-demographic dividend", "Small states", "South Asia", 
  "South Asia (IDA & IBRD)", "Sub-Saharan Africa", 
  "Sub-Saharan Africa (excluding high income)", 
  "Sub-Saharan Africa (IDA & IBRD countries)", "Upper middle income", "World"
)
```

## üìä Importa√ß√£o e Tratamento das Vari√°veis Econ√¥micas

```{r download-dados, message=FALSE, warning=FALSE}

# PIB real (constante, US$ 2015)
gdp <- WDI(
  country = "all",
  indicator = "NY.GDP.MKTP.KD",
  start = 1960,
  end = NULL,
  extra = TRUE
) %>%
  filter(!country %in% agrupamentos) %>%
  select(country, iso2c, iso3c, year, NY.GDP.MKTP.KD) %>%
  rename(pib = NY.GDP.MKTP.KD) %>%
  arrange(country, year)

# Infla√ß√£o (deflator do PIB)

cpi <- WDI(
  country = "all",
  indicator = "FP.CPI.TOTL.ZG",
  start = 1960,
  end = NULL,
  extra = TRUE
) %>%
  filter(!country %in% agrupamentos) %>%
  select(country, iso2c, iso3c, year, FP.CPI.TOTL.ZG) %>%
  rename(inflation = FP.CPI.TOTL.ZG) %>%
  arrange(country, year)

# D√≠vida governamental (% do PIB)

debt <- WDI(
  country = "all",
  indicator = "GC.DOD.TOTL.GD.ZS",
  start = 1960,
  end = NULL,
  extra = TRUE
) %>%
  filter(!country %in% agrupamentos) %>%
  select(country, iso2c, iso3c, year, GC.DOD.TOTL.GD.ZS) %>%
  rename(divida = GC.DOD.TOTL.GD.ZS) %>%
  arrange(country, year)

```

## üìÅ Bases Complementares: Independ√™ncia do BC e Expectativas

```{r download-bases-complementares, message=FALSE, warning=FALSE}
# √çndice de independ√™ncia do Banco Central (base CBIE)

cbi <- readxl::read_xlsx("CBIDta.xlsx", sheet = "Data") %>%
  select(country, iso_a3, year, cbie_index) %>%
  mutate(year = as.numeric(year)) %>%
  arrange(country, year) %>%
  rename(iso3c = iso_a3) %>%
  select(country, iso3c, year, cbie_index)

# Expectativas de infla√ß√£o (FMI)

inf_for <- readxl::read_xlsx("InflationForecast(FMI).xlsx") %>%
  select(Country, Code, Year, `Inflation forecast`) %>%
  rename(
    inflation_forecast = `Inflation forecast`,
    country = Country,
    code = Code,
    year = Year
  ) %>%
  mutate(iso3c = countrycode::countrycode(country, "country.name", "iso3c"))

# Metas de Infla√ß√£o (MacroBond)

target_panel_bond <- read_excel("target(macrobond).xlsx", sheet = "Sheet1") %>%
  rename(date = "...1") %>%
  mutate(date = as.Date(date, origin = "1899-12-30")) %>%
  mutate(year = year(date)) %>%
  group_by(year) %>%
  filter(date == max(date)) %>%
  ungroup() %>%
  pivot_longer(
    cols = -c(date, year),
    names_to = "full_country_name",
    values_to = "target"
  ) %>%
  mutate(country = gsub("^([^,]+),.*", "\\1", full_country_name)) %>%
  select(country, year, target) %>%
  filter(!is.na(target))%>%
  arrange(country, year)

# Metas de Infla√ß√£o (Eikon)

target_panel_eikon <- read_excel("target(eikon).xlsx", sheet = "valores") %>%
  mutate(country = str_to_title(GEOGN)) %>%
  mutate(across(matches("^\\d+$"), as.character)) %>%
  pivot_longer(
    cols = matches("^\\d+$"),
    names_to = "date_num",
    values_to = "target"
  ) %>%
  mutate(
    target = na_if(target, "NA"),
    date = as.Date(as.numeric(date_num), origin = "1899-12-30"),
    year = year(date),
    target = as.numeric(target)
  ) %>%
  select(country, year, target) %>%
  arrange(country, year)

# Juntando as duas bases de metas de infla√ß√£o

target <- target_panel_eikon %>%
  full_join(target_panel_bond, by = c("country", "year"), suffix = c("_eikon", "_bond")) %>%
  mutate(
    target = coalesce(target_eikon, target_bond)
  ) %>%
  select(country, year, target) %>%
  filter(year >= 2000, year <= 2023) %>%
  distinct(country, year, .keep_all = TRUE) %>%  
  mutate(
    iso3c = case_when(
      country == "Euro Area" ~ "EMU",
      TRUE ~ countrycode(country, "country.name", "iso3c")
    )
  ) %>%
  arrange(country, year)


```

## üí∞ Taxa de Juros de Pol√≠tica Monet√°ria (FMI - IFS)

```{r download-juros, message=FALSE, warning=FALSE}

# Importa√ß√£o da base IFS do FMI

ifs <- load_datasets("IFS")

# Sele√ß√£o da s√©rie de taxa de juros

data_wide <- ifs$get_series(
  freq         = "A",
  ref_area     = NULL,
  indicator    = "FPOLM_PA",
  start_period = "1960",
  end_period   = "2025"
)

# Transforma√ß√£o da base

rate <- data_wide %>%
  pivot_longer(cols = -TIME_PERIOD,
               names_to = "col_indicator",
               values_to = "taxa_juros") %>%
  mutate(
    iso2c = sub("^A\\.(.*?)\\.FPOLM_PA$", "\\1", col_indicator),
    year  = as.numeric(TIME_PERIOD)
  ) %>%
  mutate(iso2c = case_when(iso2c %in% c("7A", "U2") ~ "EA", TRUE ~ iso2c)) %>%
  mutate(
    iso3c   = countrycode(iso2c, origin = "iso2c", destination = "iso3c"),
    country = countrycode(iso2c, origin = "iso2c", destination = "country.name")
  ) %>%
  filter(!is.na(country)) %>%
  select(country, iso2c, iso3c, year, taxa_juros)
```

## Base de dados "Pr√≥pria"

```{r download-proria, message=FALSE, warning=FALSE}

acemoglu_classification <- data.frame(
  Pais = c("Argentina", "Australia", "Austria", "Belgium", "Bolivia", "Brazil", "Canada", 
           "Chile", "China", "Colombia", "Costa Rica", "Denmark", "Dominican Republic", 
           "Ecuador", "El Salvador", "Finland", "France", "Germany", "Greece", "Guatemala", 
           "Guyana", "Honduras", "India", "Indonesia", "Ireland", "Israel", "Italy", 
           "Japan", "South Korea","Malaysia", "Mexico", "Mongolia", "Nepal", "Netherlands", 
           "New Zealand", "Nicaragua", "Norway", "Pakistan", "Paraguay", "Peru", 
           "Philippines", "Portugal", "Qatar", "Singapore", "Spain", "Sweden", 
           "Switzerland", "Turkey", "United Kingdom", "United States of America", 
           "Uruguay", "Venezuela"),
  Classe = c("Medium", "High", "High", "Medium", "Medium", "Medium",
             "High", "Medium", "Medium", "Medium", "Medium", "High",
             "Medium", "Low", "Medium", "High", "Medium",
             "High", "Medium", "Low", "Medium", "Low", "Medium",
             "Low", "High", "Medium", "Medium", "Medium", "Medium", "Medium",
             "Medium", "Medium", "Medium", "High", "High", "Low",
             "High", "Low", "Low", "Medium", "Medium", "Medium",
             "Medium", "High", "Medium", "High", "High", "Medium",
             "High", "High", "Medium", "Low")
)

```

# üß© Integra√ß√£o das Bases e Constru√ß√£o da Base Final

```{r integracao-bases, message=FALSE, warning=FALSE}

# Juntando todas as vari√°veis

data <- cbi %>%
  inner_join(cpi  %>% select(-country), by = c("iso3c", "year")) %>%
  inner_join(debt %>% select(-country), by = c("iso3c", "year")) %>%
  inner_join(gdp  %>% select(-country), by = c("iso3c", "year")) %>%
  inner_join(rate %>% select(-country), by = c("iso3c", "year")) %>%
  inner_join(inf_for %>% select(-country), by = c("iso3c", "year")) %>%
  inner_join(target %>% select(-country), by = c("iso3c", "year")) %>%
  filter(year >= 2000) %>%
  select(-c(iso2c.y, iso2c.x.x, iso2c.y.y)) %>%
  rename(iso2c = iso2c.x) %>%
  group_by(country) %>%
  arrange(year) %>%
  mutate(
    taxa_juros = as.numeric(taxa_juros),
    pib_pot   = hpfilter(pib, freq = 6.25)$trend,
    hiato_pct = ((pib - pib_pot) / pib_pot) * 100,
    real_rate = ((1 + as.numeric(taxa_juros)) / (1 + inflation)) - 1
  ) %>%
  ungroup() %>%
  arrange(country, year) %>%
  select(
    country,
    iso3c,
    iso2c,
    year,
    pib,
    inflation,
    inflation_forecast,
    taxa_juros,
    cbie_index,
    divida,
    pib_pot,
    hiato_pct,
    real_rate,
    target
  ) %>%
  set_variable_labels(
    pib                = "GDP (constant 2015 US$)",
    inflation          = "Infla√ß√£o (%)",
    inflation_forecast = "Expectativa de Infla√ß√£o (%)",
    taxa_juros         = "Taxa de juros nominal (%)(BC)",
    cbie_index         = "√çndice de independ√™ncia do Banco Central (%)",
    divida             = "D√≠vida governamental (% do PIB)",
    pib_pot            = "PIB potencial (filtro HP)",
    hiato_pct          = "Hiato do produto (%)",
    real_rate          = "Taxa de juros real (%)",
    target             = "Meta de infla√ß√£o (%)"
  ) %>% 
  mutate(across(where(~ inherits(.x, "matrix")), as.numeric)) %>%
  group_by(country, year) %>%
  slice(1) %>%
  ungroup()
```

# üîé Visualiza√ß√£o Inicial da Base Final

```{r visao-geral, message=FALSE, warning=FALSE}
# Visualiza√ß√£o da base final

analisar_ocorrencias <- function(dados) {
  variaveis_banco <- c("pib", "inflation", "inflation_forecast", "target", 
                       "taxa_juros", "divida", "cbie_index")
  
  nomes_variaveis <- c("PIB", "Infla√ß√£o", "Infla√ß√£o Esperada", "Meta de Infla√ß√£o", 
                       "Taxa Nominal de Juros", "D√≠vida", "CBI")
  
  total_paises <- n_distinct(dados$country)
  total_anos <- n_distinct(dados$year)
  total_esperado <- total_paises * total_anos
  
  qtd_observada <- numeric(length(variaveis_banco))
  paises_completos <- numeric(length(variaveis_banco))
  paises_incompletos <- numeric(length(variaveis_banco))
  paises_sem_dados <- numeric(length(variaveis_banco))
  
  for (i in seq_along(variaveis_banco)) {
    var <- variaveis_banco[i]
    
    qtd_observada[i] <- sum(!is.na(dados[[var]]))
    
    por_pais <- dados %>%
      group_by(country) %>%
      summarise(
        total_anos_esperados = n(),
        anos_com_dados = sum(!is.na(.data[[var]])),
        completo = anos_com_dados == total_anos_esperados,
        sem_dados = anos_com_dados == 0,
        .groups = "drop"
      )
    
    paises_completos[i] <- sum(por_pais$completo)
    paises_sem_dados[i] <- sum(por_pais$sem_dados)
    paises_incompletos[i] <- total_paises - paises_completos[i] - paises_sem_dados[i]
  }
  
  valores_linhas <- c(
    rep(total_esperado, length(variaveis_banco)),  
    qtd_observada,                                 
    paises_completos,                              
    paises_incompletos,                            
    paises_sem_dados                               
  )
  
  list(
    nomes_variaveis = nomes_variaveis,
    valores_linhas = valores_linhas
  )
}

criar_tabela_formatada_novo <- function(titulo, subtitulo, fonte, nomes_linhas, nomes_colunas, valores_linhas) {
  
  dados <- data.frame(
    Vari√°vel = nomes_linhas,
    matrix(valores_linhas, nrow = length(nomes_linhas), byrow = FALSE)
  )
  
  colnames(dados) <- c("Vari√°vel", nomes_colunas)
  
  gt(dados) %>%
    tab_header(
      title = md("**{titulo}**"),
      subtitle = md(paste0("*", subtitulo, "*"))
    ) %>%
    tab_source_note(
      source_note = md(fonte)
    ) %>%
    tab_style(
      style = cell_text(weight = "bold"),
      locations = list(
        cells_column_labels(everything()),
        cells_body(columns = "Vari√°vel")
      )
    ) %>%
    cols_align(align = "center", columns = -1) %>%
    tab_options(table.font.size = 12) %>%
    fmt_number(columns = -1, decimals = 0, sep_mark = ".")
}


criar_tabela_ocorrencias_novo <- function(dados) {
  resultados <- analisar_ocorrencias(dados)
  
  titulo <- "An√°lise de Ocorr√™ncias nos Dados Macroecon√¥micos"
  subtitulo <- paste0("Base com ", n_distinct(dados$country), " pa√≠ses e ", 
                      n_distinct(dados$year), " anos (", min(dados$year), "-", max(dados$year), ")")
  fonte <- "Fonte: WDI, IMF-IFS, TheGlobalEconomy, Eikon, MacroBond"
  
  nomes_linhas <- c("Qtd Total Esperada", "Qtd Total Observada",
                    "Qtd de Pa√≠ses com Todos os Dados",
                    "Qtd de Pa√≠ses Incompletos",
                    "Qtd de Pa√≠ses sem nenhum dado")
  
  nomes_colunas <- resultados$nomes_variaveis
  
  valores_linhas <- matrix(resultados$valores_linhas,
                           nrow = length(nomes_linhas),
                           byrow = TRUE)
  
  criar_tabela_formatada_novo(
    titulo = titulo,
    subtitulo = subtitulo,
    fonte = fonte,
    nomes_linhas = nomes_linhas,
    nomes_colunas = nomes_colunas,
    valores_linhas = valores_linhas
  )
}

tabela_ocorrencias_novo <- criar_tabela_ocorrencias_novo(data)
print(tabela_ocorrencias_novo)


```

# üìà An√°lise Descritiva

## üìä Gr√°fico de Cobertura de Dados

```{r grafico-cobertura, message=FALSE, warning=FALSE}

data %>%
  mutate(across(
    c(pib,inflation,inflation_forecast,taxa_juros,cbie_index,divida,pib_pot,hiato_pct,real_rate,target
    ),
    ~ as.numeric(.x)
  )) %>% select(iso3c,pib,inflation,inflation_forecast,taxa_juros,cbie_index,divida,pib_pot,hiato_pct,real_rate,target
  ) %>%
  pivot_longer(cols = -iso3c,
               names_to = "variavel",
               values_to = "valor") %>%
  filter(!is.na(valor)) %>%
  count(iso3c, variavel, name = "n_obs") %>%
  ggplot(aes(
    x = fct_reorder(iso3c, -n_obs, .fun = sum),
    y = n_obs,
    fill = variavel
  )) +
  geom_bar(stat = "identity",
           color = "white",
           width = 0.85) +
  scale_fill_manual(
    values = c("#4DACD6","#4FAE62","#F6C54D","#E37D46","#C02D45","#8ecae6","#219ebc","#023047","#ffb703","#F94144"
    ),
    name = "Vari√°vel"
  ) +
  labs(
    title = "Cobertura de Dados por Pa√≠s e Vari√°vel",
    subtitle = "N√∫mero de observa√ß√µes n√£o ausentes por pa√≠s e por vari√°vel",
    x = "Pa√≠s",
    y = "N¬∫ de Observa√ß√µes",
    caption = expression(bold("Fonte: ") ~ "WDI + CBIE + FMI")
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(
      angle = 60,
      hjust = 1,
      size = 9
    ),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    axis.text.y = element_text(size = 10),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    plot.caption = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    legend.position = "none",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )

```

## üìä Gr√°fico da Evolu√ß√£o do CBI

```{r grafico-cbi, message=FALSE, warning=FALSE}

ggplot() +
  geom_ribbon(
    data = data %>%
      group_by(year) %>%
      summarise(
        mean_cbie = mean(cbie_index, na.rm = TRUE),
        sd_cbie   = sd(cbie_index, na.rm = TRUE)
      ),
    aes(
      x = year,
      ymin = mean_cbie - sd_cbie,
      ymax = mean_cbie + sd_cbie
    ),
    fill = "#2A9D8F",
    alpha = 0.2
  ) +
  geom_line(
    data = data %>%
      group_by(year) %>%
      summarise(mean_cbie = mean(cbie_index, na.rm = TRUE)),
    aes(x = year, y = mean_cbie),
    color = "#1F4E79",
    size = 1
  ) +
  geom_line(
    data = data %>%
      group_by(year) %>%
      summarise(
        mean_cbie = mean(cbie_index, na.rm = TRUE),
        sd_cbie   = sd(cbie_index, na.rm = TRUE)
      ),
    aes(x = year, y = mean_cbie + sd_cbie),
    color = "#81B1D6",
    linetype = "dotted",
    size = 0.8
  ) +
  geom_line(
    data = data %>%
      group_by(year) %>%
      summarise(
        mean_cbie = mean(cbie_index, na.rm = TRUE),
        sd_cbie   = sd(cbie_index, na.rm = TRUE)
      ),
    aes(x = year, y = mean_cbie - sd_cbie),
    color = "#81B1D6",
    linetype = "dotted",
    size = 0.8
  ) +
  geom_point(
    data = data %>%
      group_by(year) %>%
      mutate(
        mean_cbie   = mean(cbie_index, na.rm = TRUE),
        sd_cbie     = sd(cbie_index, na.rm = TRUE),
        distance_up = cbie_index - (mean_cbie + sd_cbie)
      ) %>%
      filter(cbie_index > mean_cbie + sd_cbie) %>%
      slice_max(distance_up, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = cbie_index),
    color = "darkgreen",
    size = 3
  ) +
  geom_text(
    data = data %>%
      group_by(year) %>%
      mutate(
        mean_cbie   = mean(cbie_index, na.rm = TRUE),
        sd_cbie     = sd(cbie_index, na.rm = TRUE),
        distance_up = cbie_index - (mean_cbie + sd_cbie)
      ) %>%
      filter(cbie_index > mean_cbie + sd_cbie) %>%
      slice_max(distance_up, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = cbie_index, label = iso3c),
    color = "darkgreen",
    vjust = -0.8,
    size = 3
  ) +
  geom_point(
    data = data %>%
      group_by(year) %>%
      mutate(
        mean_cbie     = mean(cbie_index, na.rm = TRUE),
        sd_cbie       = sd(cbie_index, na.rm = TRUE),
        distance_down = (mean_cbie - sd_cbie) - cbie_index
      ) %>%
      filter(cbie_index < mean_cbie - sd_cbie) %>%
      slice_max(distance_down, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = cbie_index),
    color = "red",
    size = 3
  ) +
  geom_text(
    data = data %>%
      group_by(year) %>%
      mutate(
        mean_cbie     = mean(cbie_index, na.rm = TRUE),
        sd_cbie       = sd(cbie_index, na.rm = TRUE),
        distance_down = (mean_cbie - sd_cbie) - cbie_index
      ) %>%
      filter(cbie_index < mean_cbie - sd_cbie) %>%
      slice_max(distance_down, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = cbie_index, label = iso3c),
    color = "red",
    vjust = 1.5,
    size = 3
  ) +
  scale_x_continuous(breaks = sort(unique(data$year)), expand = expansion(mult = c(0.01, 0.01))) +
  scale_y_continuous(
    limits = c(0, 1),
    breaks = seq(0, 1, 0.2),
    expand = expansion(mult = c(0, 0))
  ) +
  labs(
    title    = "Evolu√ß√£o Anual do CBI",
    subtitle = "Linhas pontilhadas de 1 desvio-padr√£o, com os outliers",
    x        = "Ano",
    y        = "√çndice de Independ√™ncia do BC (CBI)",
    caption  = expression(bold("Fonte: ") ~ "https://cbidata.org/")
  ) +
  theme(
    plot.background    = element_rect(fill = "white", color = NA),
    panel.background   = element_rect(fill = "white", color = NA),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank(),
    panel.grid.minor   = element_blank(),
    axis.line.x.bottom = element_line(color = "black"),
    axis.line.y.left   = element_line(color = "black"),
    axis.ticks         = element_line(color = "black"),
    plot.title         = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle      = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    axis.title         = element_text(face = "bold", size = 12),
    axis.text          = element_text(size = 10, color = "black"),
    plot.caption       = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    plot.margin        = margin(15, 25, 15, 25)
  )
```

## üìä Gr√°fico da Infla√ß√£o Anual 

```{r grafico-inflacao, message=FALSE, warning=FALSE}

ggplot() +
  geom_ribbon(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      summarise(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE)
      ),
    aes(
      x = year,
      ymin = mean_inflation - sd_inflation,
      ymax = mean_inflation + sd_inflation
    ),
    fill = "#2A9D8F",
    alpha = 0.2
  ) +
  geom_line(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      summarise(mean_inflation = mean(inflation, na.rm = TRUE)),
    aes(x = year, y = mean_inflation),
    color = "#1F4E79",
    size = 1
  ) +
  geom_line(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      summarise(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE)
      ),
    aes(x = year, y = mean_inflation + sd_inflation),
    color = "#81B1D6",
    linetype = "dotted",
    size = 0.8
  ) +
  geom_line(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      summarise(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE)
      ),
    aes(x = year, y = mean_inflation - sd_inflation),
    color = "#81B1D6",
    linetype = "dotted",
    size = 0.8
  ) +
  geom_point(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      mutate(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE),
        distance_up = inflation - (mean_inflation + sd_inflation)
      ) %>%
      filter(inflation > mean_inflation + sd_inflation) %>%
      slice_max(distance_up, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = inflation),
    color = "darkgreen",
    size = 3
  ) +
  geom_text(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      mutate(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE),
        distance_up = inflation - (mean_inflation + sd_inflation)
      ) %>%
      filter(inflation > mean_inflation + sd_inflation) %>%
      slice_max(distance_up, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = inflation, label = iso3c),
    color = "darkgreen",
    vjust = -0.8,
    size = 3
  ) +
  geom_point(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      mutate(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE),
        distance_down = (mean_inflation - sd_inflation) - inflation
      ) %>%
      filter(inflation < mean_inflation - sd_inflation) %>%
      slice_max(distance_down, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = inflation),
    color = "red",
    size = 3
  ) +
  geom_text(
    data = data %>%
      filter(year > 2000) %>%
      group_by(year) %>%
      mutate(
        mean_inflation = mean(inflation, na.rm = TRUE),
        sd_inflation   = sd(inflation, na.rm = TRUE),
        distance_down = (mean_inflation - sd_inflation) - inflation
      ) %>%
      filter(inflation < mean_inflation - sd_inflation) %>%
      slice_max(distance_down, with_ties = FALSE) %>%
      ungroup(),
    aes(x = year, y = inflation, label = iso3c),
    color = "red",
    vjust = 1.5,
    size = 3
  ) +
  scale_x_continuous(
    breaks = sort(unique(data %>% filter(year > 2000) %>% pull(year))),
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  scale_y_continuous(
    expand = expansion(mult = c(0.02, 0.1))
  ) +
  labs(
    title    = "Evolu√ß√£o Anual da Infla√ß√£o",
    subtitle = "Linhas pontilhadas de 1 desvio-padr√£o, com os outliers",
    x        = "Ano",
    y        = "Infla√ß√£o (%)",
    caption  = expression(bold("Fonte: ") ~ "https://data.worldbank.org/indicator/FP.CPI.TOTL.ZG")
  ) +
  theme(
    plot.background    = element_rect(fill = "white", color = NA),
    panel.background   = element_rect(fill = "white", color = NA),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank(),
    panel.grid.minor   = element_blank(),
    axis.line.x.bottom = element_line(color = "black"),
    axis.line.y.left   = element_line(color = "black"),
    axis.ticks         = element_line(color = "black"),
    plot.title         = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle      = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    axis.title         = element_text(face = "bold", size = 12),
    axis.text          = element_text(size = 10, color = "black"),
    plot.caption       = element_text(hjust = 0, size = 10, color = "black"),
    plot.margin        = margin(15, 25, 15, 25)
  )
```

## üìä Gr√°fico da Resposta da Infla√ß√£o √† Taxa Real de Juros

### üìä Gr√°fico da Resposta da Infla√ß√£o √† Taxa Real de Juros (High)

```{r grafico-inflacao-juros, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  group_by(country) %>%
  mutate(
    inflacao_a_frente = dplyr::lead(inflation, 1),
    delta_inflacao = inflacao_a_frente - inflation
  ) %>%
  ungroup() %>%
  filter(
    Classe == "High",
    !is.na(real_rate),
    !is.na(delta_inflacao),
    !is.na(cbie_index)
  ) %>%
  ggplot(aes(x = real_rate, y = delta_inflacao, color = cbie_index)) +
  geom_point(alpha = 0.5, size = 2) +
  geom_smooth(method = "lm", se = FALSE, linewidth = 1.2) +
  scale_color_viridis_c(option = "plasma", name = "Independ√™ncia BC") +
  labs(
    title = "Classe 'High': Resposta da Infla√ß√£o √† Taxa Real",
    subtitle = "Œî Infla√ß√£o (t+1 - t) vs. Taxa Real de Juros",
    x = "Taxa Real de Juros (%)",
    y = "Œî Infla√ß√£o (%)",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(size = 10, hjust = 0),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da Resposta da Infla√ß√£o √† Taxa Real de Juros (Medium)

```{r grafico-inflacao-juros-medium, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  group_by(country) %>%
  mutate(
    inflacao_a_frente = dplyr::lead(inflation, 1),
    delta_inflacao = inflacao_a_frente - inflation
  ) %>%
  ungroup() %>%
  filter(
    Classe == "Medium",
    !is.na(real_rate),
    !is.na(delta_inflacao),
    !is.na(cbie_index)
  ) %>%
  ggplot(aes(x = real_rate, y = delta_inflacao, color = cbie_index)) +
  geom_point(alpha = 0.5, size = 2) +
  geom_smooth(method = "lm", se = FALSE, linewidth = 1.2) +
  scale_color_viridis_c(option = "plasma", name = "Independ√™ncia BC") +
  labs(
    title = "Classe 'Medium': Resposta da Infla√ß√£o √† Taxa Real",
    subtitle = "Œî Infla√ß√£o (t+1 - t) vs. Taxa Real de Juros",
    x = "Taxa Real de Juros (%)",
    y = "Œî Infla√ß√£o (%)",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(size = 10, hjust = 0),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da Resposta da Infla√ß√£o √† Taxa Real de Juros (Low)

```{r grafico-inflacao-juros-low, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  group_by(country) %>%
  mutate(
    inflacao_a_frente = dplyr::lead(inflation, 1),
    delta_inflacao = inflacao_a_frente - inflation
  ) %>%
  ungroup() %>%
  filter(
    Classe == "Low",
    !is.na(real_rate),
    !is.na(delta_inflacao),
    !is.na(cbie_index)
  ) %>%
  ggplot(aes(x = real_rate, y = delta_inflacao, color = cbie_index)) +
  geom_point(alpha = 0.5, size = 2) +
  geom_smooth(method = "lm", se = FALSE, linewidth = 1.2) +
  scale_color_viridis_c(option = "plasma", name = "Independ√™ncia BC") +
  labs(
    title = "Classe 'Low': Resposta da Infla√ß√£o √† Taxa Real",
    subtitle = "Œî Infla√ß√£o (t+1 - t) vs. Taxa Real de Juros",
    x = "Taxa Real de Juros (%)",
    y = "Œî Infla√ß√£o (%)",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(size = 10, hjust = 0),
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

## üìä Gr√°fico da m√©dia da infla√ß√£o por classe institucional

```{r grafico-inflacao-classe, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(!is.na(Classe)) %>%
  group_by(year, Classe) %>%
  summarise(inflacao_media = mean(inflation, na.rm = TRUE), .groups = "drop") %>%
  ggplot(aes(x = year, y = inflacao_media, color = Classe)) +
  geom_line(size = 1.2) +
  scale_color_manual(
    values = c("Low" = "#C02D45", "Medium" = "#F6C54D", "High" = "#4FAE62")
  ) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Evolu√ß√£o da Infla√ß√£o M√©dia por N√≠vel Institucional",
    subtitle = "Classifica√ß√£o segundo Acemoglu ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL,
    y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    plot.caption = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    legend.position = "top",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

## üìä Gr√°fico do PIB por classe institucional

### üìä Gr√°fico do PIB por classe institucional (High)

```{r grafico-pib-classe, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "High", !is.na(pib)) %>%
  mutate(country = fct_reorder(country, pib, .fun = max)) %>%
  ggplot(aes(x = year, y = pib, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(
    values = c(
      "#4DACD6", "#4FAE62", "#F6C54D", "#E37D46", "#C02D45", "#8ecae6",
      "#219ebc", "#023047", "#ffb703", "#9b5de5", "#9F86C0", "#5E548E",
      "#2A9D8F", "#E76F51", "#264653", "#F8961E", "#43AA8B", "#F94144",
      "#90BE6D"
    )
  ) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Evolu√ß√£o do PIB por Pa√≠s com Institui√ß√µes 'High'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu"),
    x = NULL,
    y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    plot.caption = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico do PIB por classe institucional (Medium)

```{r grafico-pib-classe-medium, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Medium", !is.na(pib)) %>%
  mutate(country = fct_reorder(country, pib, .fun = max)) %>%
  ggplot(aes(x = year, y = pib, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(
    values = c(
      "#4DACD6", "#4FAE62", "#F6C54D", "#E37D46", "#C02D45", "#8ecae6",
      "#219ebc", "#023047", "#ffb703", "#9b5de5", "#9F86C0", "#5E548E",
      "#2A9D8F", "#E76F51", "#264653", "#F8961E", "#43AA8B", "#F94144",
      "#90BE6D"
    )
  ) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Evolu√ß√£o do PIB por Pa√≠s com Institui√ß√µes 'Medium'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu"),
    x = NULL,
    y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    plot.caption = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico do PIB por classe institucional (Low)

```{r grafico-pib-classe-low, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Low", !is.na(pib)) %>%
  mutate(country = fct_reorder(country, pib, .fun = max)) %>%
  ggplot(aes(x = year, y = pib, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(
    values = c(
      "#4DACD6", "#4FAE62", "#F6C54D", "#E37D46", "#C02D45", "#8ecae6",
      "#219ebc", "#023047", "#ffb703", "#9b5de5", "#9F86C0", "#5E548E",
      "#2A9D8F", "#E76F51", "#264653", "#F8961E", "#43AA8B", "#F94144",
      "#90BE6D"
    )
  ) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Evolu√ß√£o do PIB por Pa√≠s com Institui√ß√µes 'Low'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI + Classifica√ß√£o Acemoglu"),
    x = NULL,
    y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(
      size = 12,
      hjust = 0,
      margin = margin(b = 10)
    ),
    plot.caption = element_text(
      hjust = 0,
      size = 10,
      color = "black"
    ),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )

```

## üìä Gr√°fico da infla√ß√£o anual por classe institucional

### üìä Gr√°fico da infla√ß√£o anual por classe institucional (High)

```{r grafico-inflacao-classe-high, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "High", !is.na(inflation)) %>%
  mutate(country = fct_reorder(country, inflation, .fun = max)) %>%
  ggplot(aes(x = year, y = inflation, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "C")) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Infla√ß√£o Anual por Pa√≠s com Institui√ß√µes 'High'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da infla√ß√£o anual por classe institucional (Medium)

```{r grafico-inflacao-classe-medium, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Medium", !is.na(inflation)) %>%
  mutate(country = fct_reorder(country, inflation, .fun = max)) %>%
  ggplot(aes(x = year, y = inflation, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "H")) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Infla√ß√£o Anual por Pa√≠s com Institui√ß√µes 'Medium'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da infla√ß√£o anual por classe institucional (Low)

```{r grafico-inflacao-classe-low, message=FALSE, warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Low", !is.na(inflation)) %>%
  mutate(country = fct_reorder(country, inflation, .fun = max)) %>%
  ggplot(aes(x = year, y = inflation, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "D")) +
  scale_y_continuous(labels = label_number(scale_cut = cut_short_scale())) +
  labs(
    title = "Infla√ß√£o Anual por Pa√≠s com Institui√ß√µes 'Low'",
    subtitle = "S√©ries Temporais Individuais ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

## üìä Gr√°fico da taxa de juros nominal dos bancos centrais

### üìä Gr√°fico da taxa de juros nominal dos bancos centrais (High)

```{r  grafico-juros-classe-high, message=FALSE,warning=FALSE}
data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "High", !is.na(taxa_juros)) %>%
  mutate(country = fct_reorder(country, taxa_juros, .fun = max)) %>%
  ggplot(aes(x = year, y = taxa_juros, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(15, option = "C")) +
  labs(
    title = "Taxa de Juros Nominal dos Bancos Centrais",
    subtitle = "Pa√≠ses com Institui√ß√µes 'High' ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "IMF + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da taxa de juros nominal dos bancos centrais (Medium)

```{r  grafico-juros-classe-medium, message=FALSE,warning=FALSE}
data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Medium", !is.na(taxa_juros)) %>%
  mutate(country = fct_reorder(country, taxa_juros, .fun = max)) %>%
  ggplot(aes(x = year, y = taxa_juros, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(19, option = "H")) +
  labs(
    title = "Taxa de Juros Nominal dos Bancos Centrais",
    subtitle = "Pa√≠ses com Institui√ß√µes 'Medium' ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "IMF + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico da taxa de juros nominal dos bancos centrais (Low)

```{r  grafico-juros-classe-low, message=FALSE,warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Low", !is.na(taxa_juros)) %>%
  mutate(country = fct_reorder(country, taxa_juros, .fun = max)) %>%
  ggplot(aes(x = year, y = taxa_juros, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "D")) +
  labs(
    title = "Taxa de Juros Nominal dos Bancos Centrais",
    subtitle = "Pa√≠ses com Institui√ß√µes 'Low' ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "IMF + CBIE + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```



## üìä Gr√°fico do hiato do produto por classe institucional

### üìä Gr√°fico do hiato do produto por classe institucional (High)

```{r  grafico-hiato-classe-high, message=FALSE,warning=FALSE}
data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "High", !is.na(hiato_pct)) %>%
  mutate(country = fct_reorder(country, hiato_pct, .fun = max)) %>%
  ggplot(aes(x = year, y = hiato_pct, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(18, option = "C")) +
  labs(
    title = "Hiato do Produto por Pa√≠s (Classe 'High')",
    subtitle = "Diferen√ßa entre PIB real e potencial ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + Filtro HP + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico do hiato do produto por classe institucional (Medium)

```{r  grafico-hiato-classe-medium, message=FALSE,warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Medium", !is.na(hiato_pct)) %>%
  mutate(country = fct_reorder(country, hiato_pct, .fun = max)) %>%
  ggplot(aes(x = year, y = hiato_pct, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "H")) +
  labs(
    title = "Hiato do Produto por Pa√≠s (Classe 'Medium')",
    subtitle = "Diferen√ßa entre PIB real e potencial ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + Filtro HP + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico do hiato do produto por classe institucional (Low)

```{r  grafico-hiato-classe-low, message=FALSE,warning=FALSE}

data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(Classe == "Low", !is.na(hiato_pct)) %>%
  mutate(country = fct_reorder(country, hiato_pct, .fun = max)) %>%
  ggplot(aes(x = year, y = hiato_pct, color = country)) +
  geom_line(size = 1) +
  scale_color_manual(values = viridis::viridis(20, option = "D")) +
  labs(
    title = "Hiato do Produto por Pa√≠s (Classe 'Low')",
    subtitle = "Diferen√ßa entre PIB real e potencial ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + Filtro HP + Classifica√ß√£o Acemoglu"),
    x = NULL, y = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "left",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```


##üìä Gr√°fico da infla√ß√£o observada vs. esperada

### üìä Gr√°fico da infla√ß√£o observada vs. esperada

```{r  grafico-inflacao-vs-esperada, message=FALSE,warning=FALSE}

data %>%
  filter(!is.na(inflation), !is.na(inflation_forecast)) %>%
  filter(country %in% c("Brazil", "Chile", "Mexico", "South Africa", "United Kingdom")) %>%
  pivot_longer(cols = c(inflation, inflation_forecast),
               names_to = "tipo_inflacao", values_to = "valor") %>%
  ggplot(aes(x = year, y = valor, color = tipo_inflacao)) +
  geom_line(size = 1) +
  facet_wrap(~country, scales = "free_y") +
  scale_color_manual(
    values = c("inflation" = "#E76F51", "inflation_forecast" = "#264653"),
    labels = c("Inflacao Observada", "Inflacao Esperada")
  ) +
  labs(
    title = "Infla√ß√£o Observada vs. Esperada",
    subtitle = "Compara√ß√£o entre s√©ries para pa√≠ses selecionados",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI (Expectativas)"),
    x = NULL, y = NULL, color = NULL
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "top",
    legend.text = element_text(size = 10),
    legend.title = element_blank(),
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

### üìä Gr√°fico de barras da diferen√ßa entre infla√ß√£o observada e esperada

```{r  grafico-diferenca-inflacao, message=FALSE,warning=FALSE}
data %>%
  filter(!is.na(inflation), !is.na(inflation_forecast)) %>%
  mutate(diferenca = inflation - inflation_forecast) %>%
  filter(country %in% c("Brazil", "Chile", "Mexico", "South Africa", "United Kingdom")) %>%
  ggplot(aes(x = year, y = diferenca, fill = country)) +
  geom_col(position = "dodge") +
  facet_wrap(~country, scales = "free_y") +
  scale_fill_manual(values = c(
    "#4DACD6", "#F6C54D", "#E76F51", "#264653", "#2A9D8F"
  )) +
  labs(
    title = "Diferen√ßa entre Infla√ß√£o Observada e Esperada",
    subtitle = "Infla√ß√£o Observada - Infla√ß√£o Esperada ‚Äî 2000 a 2023",
    caption = expression(bold("Fonte: ") ~ "WDI + FMI"),
    x = NULL, y = "Diferen√ßa em pontos percentuais"
  ) +
  theme_classic(base_size = 12) +
  theme(
    axis.text.x = element_text(size = 10),
    axis.text.y = element_text(size = 10),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    legend.position = "none",
    panel.grid.major.y = element_line(color = "grey80"),
    panel.grid.major.x = element_blank()
  )
```

## üìä Gr√°fico de Barras do Princ√≠pio de Taylor (Coeficiente de Resposta √† Infla√ß√£o)

```{r regra-taylor-cbi,message=FALSE,warning=FALSE}

data %>%
  mutate(nivel_cbie = case_when(
    cbie_index <= 0.25 ~ "0.00-0.25",
    cbie_index <= 0.50 ~ "0.25-0.50",
    cbie_index <= 0.75 ~ "0.50-0.75",
    TRUE ~ "0.75-1.00"
  ),
  nivel_cbie = factor(nivel_cbie, levels = c("0.00-0.25", "0.25-0.50", "0.50-0.75", "0.75-1.00"))) %>%
  group_by(nivel_cbie) %>%
  summarise(
    coef_taylor = coef(lm(taxa_juros ~ inflation))[2],
    se_taylor = summary(lm(taxa_juros ~ inflation))$coefficients[2, 2]
  ) %>%
  ggplot(aes(x = nivel_cbie, y = coef_taylor, fill = nivel_cbie)) +
  geom_col(width = 0.7) +
  geom_errorbar(aes(ymin = coef_taylor - se_taylor, ymax = coef_taylor + se_taylor), width = 0.2) +
  geom_text(aes(label = round(coef_taylor, 2)), vjust = -0.5, size = 4) +
  scale_fill_manual(values = c("#E37D46", "#F6C54D", "#4FAE62", "#4DACD6")) +
  labs(
    title = "Regra de Taylor: Resposta da Taxa de Juros √† Infla√ß√£o",
    subtitle = "Coeficiente de resposta por n√≠vel de independ√™ncia do Banco Central",
    x = "N√≠vel de Independ√™ncia do Banco Central",
    y = "Coeficiente da Regra de Taylor",
    caption = expression(bold("Fonte: ") ~ "CBIE + FMI")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    legend.position = "none",
    panel.grid.major.y = element_line(color = "grey90")
  )
```

## üìä Gr√°fico de Barras Comparando a Volatilidade da Infla√ß√£o

```{r volatilidade-infla√ß√£o-cbi, message=FALSE,warning=FALSE}
data %>%
  mutate(nivel_cbie = case_when(
    cbie_index <= 0.25 ~ "0.00-0.25",
    cbie_index <= 0.50 ~ "0.25-0.50",
    cbie_index <= 0.75 ~ "0.50-0.75",
    TRUE ~ "0.75-1.00"
  ),
  nivel_cbie = factor(nivel_cbie, levels = c("0.00-0.25", "0.25-0.50", "0.50-0.75", "0.75-1.00"))) %>%
  group_by(nivel_cbie) %>%
  summarise(
    media_inflacao = mean(inflation, na.rm = TRUE),
    desvio_padrao = sd(inflation, na.rm = TRUE),
    coef_variacao = desvio_padrao / media_inflacao,
    contagem = n()
  ) %>%
  ggplot(aes(x = nivel_cbie, y = desvio_padrao, fill = nivel_cbie)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = round(desvio_padrao, 2)), vjust = -0.5, color = "black", size = 4) +
  scale_fill_manual(values = c("#E37D46", "#F6C54D", "#4FAE62", "#4DACD6")) +
  labs(
    title = "Volatilidade da Infla√ß√£o por N√≠vel de Independ√™ncia do BC",
    subtitle = "Desvio padr√£o da infla√ß√£o para diferentes n√≠veis de independ√™ncia",
    x = "N√≠vel de Independ√™ncia do Banco Central",
    y = "Desvio Padr√£o da Infla√ß√£o",
    caption = expression(bold("Fonte: ") ~ "CBIE + FMI")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    legend.position = "none",
    panel.grid.major.y = element_line(color = "grey90")
  )
```

## üìä Gr√°fico da Volatilidade da Infla√ß√£o por Classifica√ß√£o de Acemoglu

```{r volatilidade-acemoglu ,message=FALSE,warning=FALSE}
data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(!is.na(Classe)) %>% 
  mutate(Classe = factor(Classe, levels = c("Low", "Medium", "High"))) %>%
  group_by(Classe) %>%
  summarise(
    media_inflacao = mean(inflation, na.rm = TRUE),
    desvio_padrao = sd(inflation, na.rm = TRUE),
    coef_variacao = desvio_padrao / media_inflacao,
    contagem = n()
  ) %>%
  ggplot(aes(x = Classe, y = desvio_padrao, fill = Classe)) +
  geom_col(width = 0.7) +
  geom_text(aes(label = round(desvio_padrao, 2)), vjust = -0.5, color = "black", size = 4) +
  scale_fill_manual(values = c("#E37D46", "#F6C54D", "#4DACD6")) +
  labs(
    title = "Volatilidade da Infla√ß√£o por Classifica√ß√£o de Independ√™ncia do BC",
    subtitle = "Desvio padr√£o da infla√ß√£o para diferentes n√≠veis de independ√™ncia (Acemoglu)",
    x = "N√≠vel Institucional (Acemoglu)",
    y = "Desvio Padr√£o da Infla√ß√£o",
    caption = expression(bold("Fonte: ") ~ "Acemoglu et. al + FMI")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    legend.position = "none",
    panel.grid.major.y = element_line(color = "grey90")
  )
```

## üìä Gr√°fico da Regra de Taylor por Classifica√ß√£o de Acemoglu

```{r taylor-acemoglu,message=FALSE,warning=FALSE}
data %>%
  left_join(acemoglu_classification, by = c("country" = "Pais")) %>%
  filter(!is.na(Classe)) %>% 
  mutate(Classe = factor(Classe, levels = c("Low", "Medium", "High"))) %>%
  group_by(Classe) %>%
  summarise(
    coef_taylor = coef(lm(taxa_juros ~ inflation))[2],
    se_taylor = summary(lm(taxa_juros ~ inflation))$coefficients[2, 2]
  ) %>%
  ggplot(aes(x = Classe, y = coef_taylor, fill = Classe)) +
  geom_col(width = 0.7) +
  geom_errorbar(aes(ymin = coef_taylor - se_taylor, ymax = coef_taylor + se_taylor), width = 0.2) +
  geom_text(aes(label = round(coef_taylor, 2)), vjust = -0.5, size = 4) +
  scale_fill_manual(values = c("#E37D46", "#F6C54D", "#4DACD6")) +
  labs(
    title = "Regra de Taylor: Resposta da Taxa de Juros √† Infla√ß√£o",
    subtitle = "Coeficiente de resposta por classifica√ß√£o de Acemoglu",
    x = "N√≠vel Institucional (Acemoglu)",
    y = "Coeficiente da Regra de Taylor",
    caption = expression(bold("Fonte: ") ~ "Acemoglu et. al + FMI")
  ) +
  theme_classic(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0),
    plot.subtitle = element_text(size = 12, hjust = 0, margin = margin(b = 10)),
    plot.caption = element_text(hjust = 0, size = 10, color = "black"),
    axis.title.x = element_text(face = "bold", margin = margin(t = 10)),
    axis.title.y = element_text(face = "bold", margin = margin(r = 10)),
    legend.position = "none",
    panel.grid.major.y = element_line(color = "grey90")
  )
```

# üìàüßÆ Estima√ß√£o do Modelo GMM


## üßÆ Preparando os Dados

```{r,message=FALSE,warning=FALSE}
panel <- data %>%
  mutate(inflation_gap = inflation - target) %>%
  pdata.frame(index = c("iso3c", "year"))
```

##üßÆ GMM usando "inflation_gap" como vari√°vel dependente

```{r,message=FALSE,warning=FALSE}
gmm_model <- pgmm(
  formula = inflation_gap ~
    lag(inflation_gap, 1) +        
    cbie_index * real_rate +       
    lag(hiato_pct, 1) +            
    inflation_forecast             
  |
    lag(inflation_gap, 3:4) +      
    lag(real_rate, 2:3) +          
    lag(inflation_forecast, 3:4) + 
    cbie_index +                   
    lag(hiato_pct, 3:4),           
  data           = panel,
  effect         = "individual",
  model          = "twosteps",
  transformation = "ld"
)

summary(gmm_model)
```


# Resultados com estimativas e erros padr√£o
```{r,message=FALSE,warning=FALSE}

gmm_resultados <- tribble(
  ~Parametro, ~Estimativa, ~Erro, ~Sig,
  "Œ±‚ÇÅ (Independ√™ncia do BC √ó Taxa Real de Juros)",     0.6874, 0.3468, "*",
  "Œ±‚ÇÇ (Gap de Infla√ß√£o Defasado)",                    0.2151, 0.0777, "**",
  "Œ±‚ÇÉ (Hiato do Produto Defasado)",                   0.1997, 0.0627, "**",
  "Œ±‚ÇÑ (Expectativa de Infla√ß√£o)",                     0.6908, 0.0667, "***",
  "Œ±‚ÇÖ (√çndice de Independ√™ncia do BC)",              -3.3666, 0.4285, "***",
  "Œ±‚ÇÜ (Taxa Real de Juros)",                         -0.6239, 0.2892, "*"
)


# Criar coluna formatada com quebra de linha (usa <br> e markdown)

gmm_formatado <- gmm_resultados %>%
  mutate(
    Estimador = paste0(
      sprintf("%.4f", Estimativa), Sig, "<br>(",
      sprintf("%.4f", Erro), ")"
    )
  ) %>%
  select(Parametro, Estimador)


# Estat√≠sticas como rodap√©

texto_rodape <- paste(
  "**Estat√≠sticas e Testes de Validade**<br>",
  "N¬∫ de pa√≠ses (n): 49 (painel desbalanceado)<br>",
  "N¬∫ de observa√ß√µes (N): 1466<br>",
  "Teste de Sargan: œá¬≤(297) = 42.792 (p = 1)<br>",
  "Autocorr. AR(1): z = -1.9590 (p = 0.05011)<br>",
  "Autocorr. AR(2): z = 1.4951 (p = 0.1349)<br>",
  "Teste de Wald (coef.): œá¬≤(6) = 1138.468 (p = 9.906e-243)"
)

# Tabela com estilo e quebras de linha reais

gt(gmm_formatado) %>%
  tab_header(title = "Estimativas do Modelo GMM") %>%
  cols_label(
    Parametro = "Vari√°vel",
    Estimador = "Estimativa"
  ) %>%
  fmt_markdown(columns = "Estimador") %>%
  tab_style(
    style = cell_text(align = "center"),
    locations = cells_body(columns = everything())
  ) %>%
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_column_labels()
  ) %>%
  tab_source_note(md("**Signific√¢ncia:** *** p < 0.001, ** p < 0.01, * p < 0.05")) %>%
  tab_source_note(md(texto_rodape))
```


